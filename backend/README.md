# WorkCommunities Backend — Mock Data Overview

This document describes the mock data generated by the scripts in `app/scripts` and how to run them via Docker.

## Scripts
- `app/scripts/clear_db.py`
  - Drops all tables and recreates an empty schema.
  - Run: `docker compose exec api python -m app.scripts.clear_db`
- `app/scripts/seed_reference_data.py`
  - Seeds reference dictionaries (statuses, spheres, skills).
  - Run: `docker compose exec api python -m app.scripts.seed_reference_data`
- `app/scripts/generate_mock_data.py`
  - Generates users, companies, communities, and posts (does not touch reference dictionaries).
  - Run: `docker compose exec api python -m app.scripts.generate_mock_data`
- `app/scripts/migrate_add_company_logo.py`
  - Adds missing column `companies.logo_media_id` to keep old DBs compatible after adding company logo feature.
  - Idempotent: safe to run multiple times.
  - Run: `docker compose exec api python -m app.scripts.migrate_add_company_logo`

Recommended flow in dev:
1) Clear DB (destructive). 2) Seed reference data. 3) Generate mock data.

## Mock Data Details
The generator creates deterministic data with predictable names/keys to simplify testing.

### Users
- Count: 5 student users.
- Role: `student`.
- Phones: `+7999000XXXX` for `XXXX = 0001..0005`.
- Emails: not set (None). Passwords: not set (None).

### Companies
- Count: 3 companies.
- Names: `Mock Company 01`, `Mock Company 02`, `Mock Company 03`.
- Descriptions: `Описание компании <Name>`.

### Communities
- Count: 6 communities (2 per company).
- Names: `Community 11`, `Community 12`, `Community 21`, `Community 22`, `Community 31`, `Community 32`.
- Description: `Описание для <Community Name>`.
- Tags: comma-separated string with three parts: `mock,test,<NN>` where `<NN>` matches the community suffix (`11`, `12`, ...).
- Telegram URL: None.
- Archived: `False`.

### Posts
- Count: 18 posts (3 per community).
- Title pattern: `Пост <NN>` where `<NN>` is `11..13` for the first community, `21..23` for the second, etc.
- Body: two lines joined with a newline, to cover multiline content.
- Featured: `True` when the internal post index is divisible by 3 (i.e., every third post), else `False`.
- Author: one of the 5 student users, selected in a rotating manner per community.
- Created at: current UTC time at insert.

## How to Verify via API
- Companies: `GET /companies/` — returns all companies.
- Communities: `GET /communities/` — returns all non-archived communities.
- Skills (reference): `GET /reference/skills` — returns all skills (if seeded).
- Featured posts (per user):
  - `GET /content/users/{user_id}/posts/featured` — featured posts for an arbitrary user.
  - `GET /content/me/posts/featured` — featured posts for the current user (requires auth).

## Notes
- The generator does not create memberships, follows, events, or media; these can be added later if needed.
- If the DB schema was changed recently, and you already have tables, consider running the clear script (dev only) or use migrations.
